<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title data-i18n="additionForest.pageTitle">Addition Forest Map - Math Planet</title>
  
  <!-- Styles -->
  <link rel="stylesheet" href="../styles/main.css">
  <link rel="stylesheet" href="../styles/map.css">
  <link rel="stylesheet" href="../styles/exercise.css">
  
  <!-- Scripts -->
  <script src="../scripts/i18n.js" defer></script>
  <script type="module" src="../scripts/exercise-state.js"></script>
  <script type="module" src="../scripts/question-generator.js"></script>
  <script type="module" src="../scripts/castle-exercise.js"></script>
</head>
<body class="map-page">
  <div class="container">
    <!-- Language Switcher -->
    <div class="language-switcher-container">
      <label for="language-switcher" class="visually-hidden" data-i18n="languageSwitcher.label">Language</label>
      <select id="language-switcher" class="language-switcher" aria-label="Language">
        <option value="en">English</option>
        <option value="sv">Svenska</option>
      </select>
    </div>

    <!-- Map Container -->
    <main class="map-container">
      <div class="treasure-map">
        <!-- SVG Map with Path and Spots -->
        <!-- Treasure map viewBox: 800x600 coordinate system -->
        <!-- Path starts bottom-left (150,450) and winds to top-right (650,180) -->
        <!-- Spot 1 is highlighted/active, spots 2-5 are inactive -->
        <svg viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg" class="map-svg">
          <title>Addition Forest treasure map with five learning spots</title>
          
          <!-- Decorative forest background elements -->
          <g class="map-background">
            <!-- Trees in background -->
            <circle cx="100" cy="100" r="40" fill="#81C784" opacity="0.3"/>
            <circle cx="700" cy="120" r="35" fill="#81C784" opacity="0.3"/>
            <circle cx="150" cy="500" r="45" fill="#81C784" opacity="0.3"/>
            <circle cx="680" cy="480" r="38" fill="#81C784" opacity="0.3"/>
            
            <!-- Bushes -->
            <circle cx="50" cy="300" r="25" fill="#66BB6A" opacity="0.4"/>
            <circle cx="750" cy="350" r="30" fill="#66BB6A" opacity="0.4"/>
          </g>
          
          <!-- Winding path connecting all spots -->
          <path 
            class="map-path"
            d="M 150 450 Q 200 400, 250 380 T 350 330 Q 400 300, 450 280 T 550 230 Q 600 200, 650 180"
            stroke="#8D6E63"
            stroke-width="20"
            stroke-linecap="round"
            stroke-dasharray="5,5"
            fill="none"
            opacity="0.6"
          />
          
          <!-- Castle (Starting Point) - Interactive Element -->
          <g id="castle-spot" class="map-spot castle-spot" data-spot="castle" role="button" tabindex="0" aria-label="Castle - Starting Point">
            <!-- Castle Structure -->
            <rect x="125" y="420" width="50" height="60" fill="#B0B0B0" stroke="#808080" stroke-width="2"/>
            <polygon points="120,420 180,420 175,400 125,400" fill="#909090" stroke="#707070" stroke-width="2"/>
            
            <!-- Castle Towers -->
            <rect x="120" y="405" width="15" height="25" fill="#B0B0B0" stroke="#808080" stroke-width="1"/>
            <rect x="165" y="405" width="15" height="25" fill="#B0B0B0" stroke="#808080" stroke-width="1"/>
            <polygon points="120,405 127.5,390 135,405" fill="#909090"/>
            <polygon points="165,405 172.5,390 180,405" fill="#909090"/>
            
            <!-- Castle Door -->
            <rect x="140" y="455" width="20" height="25" fill="#654321" stroke="#4A3219" stroke-width="1"/>
            
            <!-- Castle Windows -->
            <rect x="132" y="435" width="10" height="10" fill="#FFE87C" stroke="#D4AF37" stroke-width="1"/>
            <rect x="158" y="435" width="10" height="10" fill="#FFE87C" stroke="#D4AF37" stroke-width="1"/>
            
            <!-- Hover indicator (visible on hover) -->
            <circle cx="150" cy="450" r="40" fill="rgba(255, 215, 0, 0.2)" class="castle-hover-indicator" opacity="0"/>
          </g>
          
          <!-- Spot 1 - Starting Point (HIGHLIGHTED) -->
          <g class="map-spot spot-1 highlighted" transform="translate(150, 450)">
            <circle class="spot-glow" r="35" fill="#FFD54F" opacity="0.4"/>
            <circle class="spot-outer" r="28" fill="#4CAF50" stroke="#2E7D32" stroke-width="3"/>
            <circle class="spot-inner" r="20" fill="#66BB6A"/>
            <text class="spot-number" x="0" y="8" text-anchor="middle" font-size="24" font-weight="bold" fill="#FFFFFF">1</text>
            
            <!-- Flag marker on spot 1 -->
            <g transform="translate(25, -35)">
              <line x1="0" y1="0" x2="0" y2="30" stroke="#8B4513" stroke-width="2"/>
              <path d="M 0 0 L 15 7 L 0 14 Z" fill="#FFD54F"/>
            </g>
          </g>
          
          <!-- Spot 2 - Not yet available -->
          <g class="map-spot spot-2 inactive" transform="translate(300, 360)">
            <circle class="spot-outer" r="24" fill="#A5D6A7" stroke="#81C784" stroke-width="2" opacity="0.7"/>
            <circle class="spot-inner" r="16" fill="#C8E6C9" opacity="0.7"/>
            <text class="spot-number" x="0" y="7" text-anchor="middle" font-size="20" font-weight="bold" fill="#888888">2</text>
          </g>
          
          <!-- Spot 3 - Not yet available -->
          <g class="map-spot spot-3 inactive" transform="translate(450, 280)">
            <circle class="spot-outer" r="24" fill="#A5D6A7" stroke="#81C784" stroke-width="2" opacity="0.7"/>
            <circle class="spot-inner" r="16" fill="#C8E6C9" opacity="0.7"/>
            <text class="spot-number" x="0" y="7" text-anchor="middle" font-size="20" font-weight="bold" fill="#888888">3</text>
          </g>
          
          <!-- Spot 4 - Not yet available -->
          <g class="map-spot spot-4 inactive" transform="translate(550, 230)">
            <circle class="spot-outer" r="24" fill="#A5D6A7" stroke="#81C784" stroke-width="2" opacity="0.7"/>
            <circle class="spot-inner" r="16" fill="#C8E6C9" opacity="0.7"/>
            <text class="spot-number" x="0" y="7" text-anchor="middle" font-size="20" font-weight="bold" fill="#888888">4</text>
          </g>
          
          <!-- Spot 5 - Final destination - Not yet available -->
          <g class="map-spot spot-5 inactive" transform="translate(650, 180)">
            <circle class="spot-outer" r="24" fill="#A5D6A7" stroke="#81C784" stroke-width="2" opacity="0.7"/>
            <circle class="spot-inner" r="16" fill="#C8E6C9" opacity="0.7"/>
            <text class="spot-number" x="0" y="7" text-anchor="middle" font-size="20" font-weight="bold" fill="#888888">5</text>
            
            <!-- Star marker on final spot -->
            <g transform="translate(0, -30)" opacity="0.5">
              <path d="M 0,-8 L 2,-2 L 8,-2 L 3,2 L 5,8 L 0,4 L -5,8 L -3,2 L -8,-2 L -2,-2 Z" fill="#FFD700"/>
            </g>
          </g>
          
          <!-- ARIA labels for accessibility -->
          <text class="sr-only">
            <tspan data-i18n="additionForest.spot1Label">Spot 1 - Start here</tspan>
            <tspan data-i18n="additionForest.spot2Label">Spot 2 - Not yet available</tspan>
            <tspan data-i18n="additionForest.spot3Label">Spot 3 - Not yet available</tspan>
            <tspan data-i18n="additionForest.spot4Label">Spot 4 - Not yet available</tspan>
            <tspan data-i18n="additionForest.spot5Label">Spot 5 - Not yet available</tspan>
          </text>
        </svg>
      </div>
      
      <!-- Exercise Interaction Area (Initially hidden) -->
      <div id="interaction-area" class="interaction-area hidden" role="region" aria-labelledby="exercise-title">
        <!-- Princess Character -->
        <div class="princess-container">
          <svg class="princess-svg" width="100" height="120" viewBox="0 0 100 120" aria-hidden="true">
            <!-- Princess Crown -->
            <polygon points="40,20 50,10 60,20 55,25 45,25" fill="#FFD700" stroke="#FFA000" stroke-width="1"/>
            <circle cx="50" cy="25" r="3" fill="#FF1744"/>
            
            <!-- Princess Head -->
            <circle cx="50" cy="40" r="15" fill="#FFE0BD" stroke="#D4A574" stroke-width="1"/>
            
            <!-- Princess Hair -->
            <path d="M 35 35 Q 35 25, 50 25 Q 65 25, 65 35 Q 65 45, 60 50 L 40 50 Q 35 45, 35 35" fill="#8B4513" stroke="#654321" stroke-width="1"/>
            
            <!-- Princess Eyes -->
            <circle cx="45" cy="40" r="2" fill="#333"/>
            <circle cx="55" cy="40" r="2" fill="#333"/>
            
            <!-- Princess Smile -->
            <path d="M 45 45 Q 50 48, 55 45" stroke="#333" stroke-width="1" fill="none"/>
            
            <!-- Princess Dress -->
            <path d="M 50 55 L 35 100 L 40 100 L 50 75 L 60 100 L 65 100 Z" fill="#FF69B4" stroke="#C2185B" stroke-width="1"/>
            
            <!-- Princess Arms -->
            <line x1="40" y1="60" x2="30" y2="75" stroke="#FFE0BD" stroke-width="4" stroke-linecap="round"/>
            <line x1="60" y1="60" x2="70" y2="75" stroke="#FFE0BD" stroke-width="4" stroke-linecap="round"/>
          </svg>
        </div>
        
        <!-- Princess Message -->
        <div class="princess-message">
          <p id="princess-greeting" data-i18n="additionForest.exercise1.princessGreeting">Welcome to my castle! Let's practice addition together.</p>
        </div>
        
        <!-- Question Display -->
        <div class="question-display">
          <h2 id="exercise-title" class="sr-only" data-i18n="additionForest.exercise1.questionPrompt">Solve this addition problem</h2>
          <div id="question-text" class="question-text" role="text" aria-live="polite"></div>
        </div>
        
        <!-- Answer Input -->
        <div class="answer-input-container">
          <label for="answer-input" class="answer-label" data-i18n="additionForest.exercise1.inputLabel">Your answer:</label>
          <input 
            type="number" 
            id="answer-input" 
            class="answer-input" 
            data-i18n-placeholder="additionForest.exercise1.answerPlaceholder"
            placeholder="Enter your answer"
            aria-describedby="feedback-message"
            min="0"
            max="200"
          />
        </div>
        
        <!-- Submit Button -->
        <button id="submit-button" class="submit-button" data-i18n="additionForest.exercise1.submitButton">Check Answer</button>
        
        <!-- Feedback Message -->
        <div id="feedback-message" class="feedback-message" role="alert" aria-live="assertive"></div>
      </div>
      
    </main>
  </div>
</body>
</html>
